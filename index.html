<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Main Screen</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="styles/style.css">

<script type="module">
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAUZZBN9qoM34lsvyEOeK2znSSw6kKMcEE",
      authDomain: "yikegames-website.firebaseapp.com",
      projectId: "yikegames-website",
      storageBucket: "yikegames-website.firebasestorage.app",
      messagingSenderId: "1086586566551",
      appId: "1:1086586566551:web:b64dfc25e6e6ac5a09b6d2",
      measurementId: "G-FXH0D07D86"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    onAuthStateChanged(auth, (user) => {
      // ...inside onAuthStateChanged...
      const loginBtnAnchor = document.getElementById("login-register-btn");
      const loginBtnButton = loginBtnAnchor.querySelector('button');

      if (user) {
       if (loginBtnButton) {
        loginBtnButton.textContent = "Account";
        loginBtnAnchor.href = "other/account.html";
       }
}

    });
</script>
</head>
<body>
    <header>
        <h1>Welcome to the home page!</h1>
        <p class="subtitle">Go to any section using the buttons below</p>
    </header>

    <div class="main-content">
        <div class="left-sidebar">
            <section class="warning">
                <p class="warning1">⚠️ This site is designed for desktop. Mobile experience may be limited. ⚠️</p>
            </section>
            <section class="app">
                <p class="app1">There's a desktop app for this! available on <a href="https://github.com/explysm/yikegames">Windows & Linux</a>. (Still in development)</p>
            </section>
            
            <div class="divider"></div>

            <section class="web">
                <a href="https://yike.games">yike.games</a>
                <a href="https://yikegames.itch.io">yikegames.itch.io</a>
                <a href="https://github.com/explysm">github.com/explysm</a>
            </section>
            
            <div class="divider"></div>

            <section class="social-links">
                <a href="https://x.com/AsnCEe">Twitter</a>
            </section>
        </div>

        <div class="center-column">
            <section class="login-container">
                <a id="login-register-btn" href="other/login.html"><button class="btn login-btn">Login / Register</button></a>
            </section>

            <section class="buttons-center">
                <a href="https://games.yike.games"><button class="btn">Games</button></a>
                <a href="other/aboutme.html"><button class="btn">About Me</button></a>
                <a href="other/chat.html"><button class="btn">Global Chat</button></a>
                <a href="other/devlog.html"><button class="btn">Dev Log</button></a>
            </section>
        </div>

        <div class="right-sidebar">
            <section id="commits" class="updates">
              <h2>Latest Website Commits</h2>
              <ul id="commit-list"></ul>
            </section>
              
            <section id="commits-games" class="updates">
              <h2>Latest Game Commits</h2>
              <ul id="commit-list-games"></ul>
            </section>
        </div>
    </div>

    <div class="divider"></div>

    <script>
    async function loadCommits() {
      const repo = "explysm/yikegame-website";
      const response = await fetch(`https://api.github.com/repos/${repo}/commits`);
      const commits = await response.json();
      const list = document.getElementById("commit-list");
      list.innerHTML = "";
      commits.slice(0, 5).forEach(c => {
        const li = document.createElement("li");
        li.innerHTML = `<strong>${c.commit.author.name}</strong>: ${c.commit.message} 
                        <br><small>${new Date(c.commit.author.date).toLocaleString()}</small>`;
        list.appendChild(li);
      });
    }
    loadCommits();
    </script>
      
    <script>
    async function loadGameCommits() {
      const repo = "explysm/Games";
      const response = await fetch(`https://api.github.com/repos/${repo}/commits`);
      const commits = await response.json();
      const list = document.getElementById("commit-list-games");
      list.innerHTML = "";
      commits.slice(0, 5).forEach(c => {
        const li = document.createElement("li");
        li.innerHTML = `<strong>${c.commit.author.name}</strong>: ${c.commit.message} 
                        <br><small>${new Date(c.commit.author.date).toLocaleString()}</small>`;
        list.appendChild(li);
      });
    }
    loadGameCommits();
    </script>

    <script>
      document.body.classList.add('fade-enter');
      setTimeout(() => {
        document.body.classList.add('fade-enter-active');
      }, 10);

      document.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', function(e) {
          const href = this.getAttribute('href');
          if (href && !href.startsWith('http')) {
            e.preventDefault();
            document.body.classList.remove('fade-enter-active');
            document.body.classList.add('fade-exit-active');
            setTimeout(() => { window.location.href = href; }, 500);
          }
        });
      });
    </script>
</body>
</html>
